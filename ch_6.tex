\section{Глава 6. Случайные блуждания.}
\subsection{Случайные блуждания и закон повторного логарифма}
Пусть $\{ \xi_i\}_{i \geqslant 1}$~--- последовательность независимых одинаково распределенных случайных величин таких, что $\E \xi_n = 0, \E \xi_n^2 = \sigma^2$.
\begin{definition}
Случайная величина $S_n = \sum\limits_{i = 1}^n \xi_i$ называется случайным блужданием.
\end{definition}
Известно (из Ц.П.Т.), что $ \varlimsup\limits_{n \rightarrow \infty} \dfrac{S_n}{\sqrt{n}} = + \infty$, а $ \varliminf\limits_{n \rightarrow \infty} \dfrac{S_n}{\sqrt{n}} = - \infty$ (Можно получить с помощью теоремы Муавра-Лапласа). С другой стороны,
$$ \sum\limits_{n = 1}^\infty \dfrac{\E \xi_n^2}{n \ln^2 n} = \sum\limits_{n = 1}^\infty  \frac{\sigma^2}{n \ln^2 n} < + \infty.$$
Следовательно, по теореме Колмогорова-Хинчина о сходимости ряда почти наверное $\sum\limits_{n = 1}^\infty \dfrac{\xi_n}{\sqrt{n} \ln n}$ сходится почти наверное, значит, по лемме Кронекера, 
$$ \dfrac{1}{\sqrt{n} \ln n} \sum\limits_{k = 1}^n \sqrt{k} \ln k \dfrac{\xi_k}{ \sqrt{k} \ln k} = \dfrac{S_n}{\sqrt{n} \ln n} \xrightarrow[n \rightarrow \infty]{\text{п.н.}} 0.$$ Значит $S_n$ не выходит за $\varepsilon \sqrt{n}$ начиная с некоторого момента п.н.
\begin{theorem} (Теорема Муавра-Лапласа)

    Независимые случайные величины $\xi_i \sim \text{Bern}(p)$. 
    $$\sup_{-\infty \leqslant a < b \leqslant +\infty} \Bigg| \P\bigg( a \leqslant \dfrac{S_n - np}{\sqrt{npq}} \leqslant b \bigg) - \int\limits_a^b \dfrac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}dx \Bigg| \xrightarrow{n \rightarrow \infty} 0.$$
\end{theorem}
\begin{definition}
	Функция $\varphi^* = \varphi^*(n)$, $n > 1$ называется верхней для $S_n$, если $S_n(\omega) < \varphi^*(n)$ почти наверное для всех $n$, начиная с некоторого $n_0(\omega)$.
\end{definition}
\begin{definition}
	Функция $\varphi_* = \varphi_*(n)$, $n > 1$ называется нижней для $S_n$, если $S_n(\omega) > \varphi_*(n)$ почти наверное для бесконечно многих $n$ (бесконечно часто).
\end{definition}
То есть $\forall \varepsilon \ \varphi^* (n) = \varepsilon \sqrt{n} \ln n$~--- верхняя для произвольного случайного блуждания, $\varphi_* (n) = \varepsilon \sqrt{n}$~--- нижняя. Пусть некая функция $\varphi(n)$~--- <<точная асимптотика>>, возьмем $\varphi_\varepsilon^* = (1 + \varepsilon) \varphi; \  \varphi_{*\varepsilon} = (1 - \varepsilon)\varphi$ для $\varepsilon > 0$. Тогда 
	\begin{multline*}
		\left\{ \varlimsup\limits_{n \rightarrow \infty} \dfrac{S_n}{\varphi(n)} \leqslant 1 \right\} = 
		\left\{ \lim\limits_{n \rightarrow \infty} \sup\limits_{m \geqslant n} \dfrac{S_m}{\varphi(m)} \leqslant 1 \right\} = \\ =
		\left\{ \forall \varepsilon > 0~\text{и некоторого}~n_\varepsilon \hookrightarrow \sup\limits_{m \geqslant n_\varepsilon} \dfrac{S_m}{\varphi(m)} \leqslant 1 + \varepsilon \right\} = \\ =
		\big\{ \forall \varepsilon > 0~~\forall m \geqslant n_\varepsilon \hookrightarrow S_m \leqslant (1 + \varepsilon) \varphi(m) \big\} \quad \Leftrightarrow \quad 
		(1 + \varepsilon) \varphi(m)~\text{--- верхняя.}
	\end{multline*}
Аналогично,
	\begin{multline*}
		\left\{ \varlimsup\limits_{n \rightarrow \infty} \dfrac{S_n}{\varphi(n)} \geqslant 1 \right\} = 
		\left\{ \lim\limits_{n \rightarrow \infty} \sup\limits_{m \geqslant n} \dfrac{S_m}{\varphi(m)} \geqslant 1 \right\} = \\ =
		\big\{ \forall \varepsilon > 0~\text{и для беск. многих}~n_\varepsilon \hookrightarrow S_m \geqslant (1 - \varepsilon) \varphi(m) \big\}  \Leftrightarrow \\ \Leftrightarrow (1 - \varepsilon) \varphi(m)~\text{--- нижняя.}
	\end{multline*}

Отметим, $\forall \varepsilon > 0 \hookrightarrow \varphi_\varepsilon^* = (1 + \varepsilon) \varphi~\text{--- верхняя} \quad \Leftrightarrow \quad  \P\left( \varlimsup\limits_{n \rightarrow \infty} \dfrac{S_n}{\varphi(n)} \leqslant 1 \right) = 1$. Аналогично, $\forall \varepsilon > 0 \hookrightarrow \varphi_\varepsilon^* = (1 + \varepsilon) \varphi~\text{--- нижняя} \quad \Leftrightarrow \quad  \P\left( \varliminf\limits_{n \rightarrow \infty} \dfrac{S_n}{\varphi(n)} \geqslant 1 \right) = 1$.
\begin{theorem}[закон повторного логарифма (ЗПЛ)][б/д]~

	Пусть $\{ \xi_n \}_{n \geqslant 1}$~--- независимые одинаково распределенные случайные величины, $\E \xi_1 = 0, \E \xi_1^2 = \sigma^2, 0 < \sigma^2 < + \infty$. 
	
	Тогда 
	$$ \P \left( \varlimsup\limits_{n \rightarrow \infty} \dfrac{S_n}{\varphi(n)} = 1 \right) = 1,  \varphi(n) = \sqrt{
	2 \sigma^2 n \ln\ln n}. $$
\end{theorem}
\begin{note}
	Применяя ЗПЛ к $S_n$, получаем, что $\P \left(\varliminf\limits_{n \rightarrow \infty} \dfrac{S_n}{\varphi(n)} = -1 \right) = 1$.
\end{note}

За нижнюю ветку $S_n$ выходит бесконечно часто (см.~Рис.\,\ref{pic:lrl}), а за верхнюю лишь конечное число раз (почти наверное не выходит). Траектория пересекает горизонтальную ось бесконечное число раз.

\begin{figure}[h!]
	\centering
	\includegraphics[width = 7cm]{lrl}
	\caption{Поведение верхней и нижней функции случайного блуждания}
	\label{pic:lrl}
\end{figure}